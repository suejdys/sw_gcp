<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weight Graph</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        canvas {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Weight Graph</h1>
    <p>캘린더에서 입력된 데이터를 기반으로 몸무게 그래프를 작성합니다.</p>

    <!-- 그래프 표시 영역 -->
    <canvas id="weightChart" width="400" height="200"></canvas>

    <script>
        const apiBaseUrl = 'https://your-api-url.com'; // API 서버 URL
        const userId = 'user123'; // 로그인된 사용자 ID (예시)

        const labels = []; // 날짜 데이터
        const weights = []; // 몸무게 데이터

        // Chart.js 초기화
        const ctx = document.getElementById('weightChart').getContext('2d');
        const weightChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Weight (kg)',
                    data: weights,
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                scales: {
                    x: {
                        title: { display: true, text: 'Date' }
                    },
                    y: {
                        beginAtZero: false,
                        title: { display: true, text: 'Weight (kg)' }
                    }
                }
            }
        });

        // 서버에서 몸무게 데이터 가져오기
        async function fetchWeights() {
            try {
                // 서버에 요청하여 데이터 가져오기
                const response = await fetch(`${apiBaseUrl}/weights?userId=${userId}`);
                const data = await response.json();

                labels.length = 0;
                weights.length = 0;

                // 가져온 데이터를 날짜 순으로 정렬
                data.sort((a, b) => new Date(a.date) - new Date(b.date));
                data.forEach(item => {
                    labels.push(item.date);
                    weights.push(item.weight);
                });

                // 그래프 업데이트
                weightChart.update();
            } catch (error) {
                console.error('Error fetching weights:', error);
            }
        }

        // 페이지 로드 시 데이터 가져오기
        window.onload = fetchWeights;
    </script>
</body>
</html>
